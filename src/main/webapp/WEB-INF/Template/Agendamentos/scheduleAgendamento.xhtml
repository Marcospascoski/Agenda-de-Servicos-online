<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">


    <h:form id="form">  

        <p:messages id="mensagens" autoUpdate="" closable="true" />

        <p:schedule widgetVar="agenda" value="#{AgendaBean.eventoModel}" style="margin-top: 20px" view="agendaWeek"
                    aspectRatio="3" slotMinutes="30" draggable="false" timeZone="UTC" axisFormat="HH:mm" locale="pt">

            <!-- aqui são os eventos -->
            <p:ajax event="dateSelect" listener="#{AgendaBean.onDateSelect}" 
                    update="detalheAgendamento" oncomplete="agendaDialog.show()"/>  
            <p:ajax event="eventSelect" listener="#{AgendaBean.onEventSelect}" 
                    update="detalheAgendamento" oncomplete="agendaDialog.show()"/>  
            <p:ajax event="eventMove" listener="#{AgendaBean.onEventMove}" 
                    update="mensagens" oncomplete="calendario.update()"/>  
            <p:ajax event="eventResize" listener="#{AgendaBean.onEventResize}" 
                    update="mensagens" oncomplete="calendario.update()"/>  

        </p:schedule>

        <p:dialog widgetVar="agendaDialog" 
                  header="Agendamento"  width="500"
                  resizable="false" modal="true">  

            <p:outputPanel id="detalheAgendamento">

                <p:panelGrid columns="2" styleClass="semBorda">  

                    <p:outputLabel value="Serviço" for="servico" /> 
                    <p:selectOneMenu id="servico" value="#{AgendaBean.servicoSelecionado}">
                        <f:selectItem itemLabel="Selecione o serviço" />
                        <f:selectItems value="#{AgendaBean.servicosRaizes}" var="servico"
                                       itemValue="#{servico}" itemLabel="#{servico.nome}" />
                    </p:selectOneMenu>

                    <p:outputLabel value="Observação" for="descricao" style="alignment-adjust: auto"/> 
                    <p:inputText id="descricao" value="#{AgendaBean.agenda.observacao}" maxlength="60" style="width: 300px;"/>  

                    <h:outputLabel value="Data/Hora Inicial" for="inicio"  />  
                    <p:calendar id="inicio" value="#{AgendaBean.agenda.dataInicio}" pattern="dd/MM/yyyy HH:mm" locale="pt" timeZone="UTC" readonlyInput="true" navigator="false"
                                pages="1" mode="popup" mindate="#{AgendaBean.dataHoje}"/>

                    <p:outputLabel  value="Data/Hora Final" for="fim" />  
                    <p:calendar id="fim" value="#{AgendaBean.agenda.dataFim}"   pattern="dd/MM/yyyy HH:mm" locale="pt" timeZone="UTC" readonlyInput="true" navigator="false"
                                pages="1" mode="popup" mindate="#{AgendaBean.dataHoje}"/>

                    <p:outputLabel for="diaTodo" value="Dia todo?:" />  
                    <p:selectBooleanCheckbox id="diaTodo" value="#{AgendaBean.agenda.diaTodo}" />

                </p:panelGrid>  

                <p:separator/>

                <p:commandButton value="Agendar" action="#{AgendaBean.salvar}" oncomplete="calendario.update() agendaDialog.hide();" update="mensagens @form"  />  

            </p:outputPanel>

        </p:dialog>


    </h:form>  


</ui:composition>




